import{d as _,u as E,g as c,r as v,h as p,t as f,j as V,i as g,_ as R,c as P,a as t,w as n,o as C,b as w}from"./index-f48438ef.js";import{E as $,a as h}from"./form-item-b08d89a2.js";import{E as U}from"./button-f8fb6abb.js";import{E as y}from"./input-86eb12f4.js";import"./_initCloneObject-69a7e4eb.js";const B=_({name:"RegisterView",components:{},setup(){const r=E(),o=c(),u=v(),d=p({validateUsername:(a,s,e)=>{s===""?e(new Error("请输入用户名")):/^[a-zA-Z0-9]{5,15}$/.test(s)?e():e(new Error("用户名必须是字母或数字的组合,长度在[5,15]"))},validatePassword(a,s,e){if(s==="")e(new Error("请输入密码"));else if(!/^[\S]{5,15}$/.test(s))e(new Error("用户名必须是字母或数字或可见特殊字符的组合,长度在[5,15]"));else{if(l.registerForm.checkPassword!==""){if(!u.value)return;u.value.validateField("checkPassword",()=>null)}e()}},validateConfirmPassword(a,s,e){s===""?e(new Error("请再次输入密码以确认")):s!==l.registerForm.password?e(new Error("两次输入的密码不匹配")):e()},handleRegister:a=>{a&&a.validate(s=>{if(s)console.log(l.registerForm.username),console.log(l.registerForm.password),V({username:l.registerForm.username,password:l.registerForm.password}).then(e=>{g.success({title:"注册成功",message:"欢迎进入CTFz"}),r.dispatch("UserInfo/updateUserInfo",e.data),o.replace("/")},e=>{g.error({title:"注册失败",message:e})});else return!1})},resetForm:a=>{a&&a.resetFields()}}),l=p({registerForm:{username:"",password:"",checkPassword:""},registerRules:{username:[{validator:d.validateUsername,trigger:"blur"}],password:[{validator:d.validatePassword,trigger:"blur"}],checkPassword:[{validator:d.validateConfirmPassword,trigger:"blur"}]}});return{registerFormRef:u,...f(l),...f(d)}}});const k={class:"register"};function I(r,o,u,d,l,a){const s=y,e=h,m=U,F=$;return C(),P("div",k,[t(F,{model:r.registerForm,rules:r.registerRules,"status-icon":"",ref:"registerFormRef","label-width":"120px",size:"default"},{default:n(()=>[t(e,{label:"用户名",prop:"username"},{default:n(()=>[t(s,{modelValue:r.registerForm.username,"onUpdate:modelValue":o[0]||(o[0]=i=>r.registerForm.username=i)},null,8,["modelValue"])]),_:1}),t(e,{label:"密码",prop:"password"},{default:n(()=>[t(s,{modelValue:r.registerForm.password,"onUpdate:modelValue":o[1]||(o[1]=i=>r.registerForm.password=i),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(e,{label:"确认密码",prop:"checkPassword"},{default:n(()=>[t(s,{modelValue:r.registerForm.checkPassword,"onUpdate:modelValue":o[2]||(o[2]=i=>r.registerForm.checkPassword=i),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(e,null,{default:n(()=>[t(m,{type:"primary",onClick:o[3]||(o[3]=i=>r.handleRegister(r.registerFormRef))},{default:n(()=>[w("提交")]),_:1}),t(m,{onClick:o[4]||(o[4]=i=>r.resetForm(r.registerFormRef))},{default:n(()=>[w("重置")]),_:1})]),_:1})]),_:1},8,["model","rules"])])}const S=R(B,[["render",I],["__scopeId","data-v-1fe76ee4"]]);export{S as default};
