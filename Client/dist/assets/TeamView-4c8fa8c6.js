import{k as ie,az as re,aN as ue,n as G,d as B,aO as ce,x as me,r as D,y as V,aP as pe,o as _,B as v,w as o,f,C as N,D as I,G as de,F as fe,a7 as _e,Y as k,b as d,L as b,a,K as he,M as Ce,R as be,S as ve,W as ke,h as A,t as E,_ as U,E as P,u as M,c as S,I as Ie,p as Te,e as ye,ao as ge,A as Ee,aQ as $,aJ as j,aR as Be,aS as $e,i as F,aT as K,aU as Fe,aV as we,aW as De}from"./index-f48438ef.js";import{E as R}from"./card-a156ac9e.js";import{a as X,E as Z}from"./table-column-b5089e17.js";import{b as Ae,a as Le}from"./col-a1fd19f5.js";import{b as Q,E as L}from"./button-f8fb6abb.js";import{h as x}from"./moment-fbc5633a.js";import{E as Ue}from"./overlay-3223c60b.js";import{a as Ne,E as je}from"./form-item-b08d89a2.js";import{E as Ve}from"./input-86eb12f4.js";import{E as Re}from"./divider-91fb6dfc.js";import"./_initCloneObject-69a7e4eb.js";const Se=ie({title:String,confirmButtonText:String,cancelButtonText:String,confirmButtonType:{type:String,values:Q,default:"primary"},cancelButtonType:{type:String,values:Q,default:"text"},icon:{type:re,default:()=>ue},iconColor:{type:String,default:"#f90"},hideIcon:{type:Boolean,default:!1},hideAfter:{type:Number,default:200},teleported:G.teleported,persistent:G.persistent,width:{type:[String,Number],default:150}}),Pe={confirm:e=>e instanceof MouseEvent,cancel:e=>e instanceof MouseEvent},Me=B({name:"ElPopconfirm"}),qe=B({...Me,props:Se,emits:Pe,setup(e,{emit:s}){const i=e,{t:m}=ce(),u=me("popconfirm"),h=D(),p=()=>{var n,g;(g=(n=h.value)==null?void 0:n.onClose)==null||g.call(n)},t=V(()=>({width:pe(i.width)})),l=n=>{s("confirm",n),p()},r=n=>{s("cancel",n),p()},C=V(()=>i.confirmButtonText||m("el.popconfirm.confirmButtonText")),c=V(()=>i.cancelButtonText||m("el.popconfirm.cancelButtonText"));return(n,g)=>(_(),v(I(be),Ce({ref_key:"tooltipRef",ref:h,trigger:"click",effect:"light"},n.$attrs,{"popper-class":`${I(u).namespace.value}-popover`,"popper-style":I(t),teleported:n.teleported,"fallback-placements":["bottom","top","right","left"],"hide-after":n.hideAfter,persistent:n.persistent}),{content:o(()=>[f("div",{class:N(I(u).b())},[f("div",{class:N(I(u).e("main"))},[!n.hideIcon&&n.icon?(_(),v(I(de),{key:0,class:N(I(u).e("icon")),style:fe({color:n.iconColor})},{default:o(()=>[(_(),v(_e(n.icon)))]),_:1},8,["class","style"])):k("v-if",!0),d(" "+b(n.title),1)],2),f("div",{class:N(I(u).e("action"))},[a(I(L),{size:"small",type:n.cancelButtonType==="text"?"":n.cancelButtonType,text:n.cancelButtonType==="text",onClick:r},{default:o(()=>[d(b(I(c)),1)]),_:1},8,["type","text"]),a(I(L),{size:"small",type:n.confirmButtonType==="text"?"":n.confirmButtonType,text:n.confirmButtonType==="text",onClick:l},{default:o(()=>[d(b(I(C)),1)]),_:1},8,["type","text"])],2)],2)]),default:o(()=>[n.$slots.reference?he(n.$slots,"reference",{key:0}):k("v-if",!0)]),_:3},16,["popper-class","popper-style","teleported","hide-after","persistent"]))}});var Oe=ve(qe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popconfirm/src/popconfirm.vue"]]);const ee=ke(Oe),ze=B({name:"JoinInfo",props:{joinRequestInfoList:{type:Object,default:()=>[]}},emits:["optionClick"],components:{},setup(e,s){const i=A({option:(m,u)=>{s.emit("optionClick",m.id,u)},formatTime:m=>x(m).format("YYYY-MM-DD HH:mm:ss")});return{...E(i),...E(e)}}}),Ye=f("h3",null,"申请信息",-1);function Je(e,s,i,m,u,h){const p=P,t=X,l=L,r=Z,C=R;return _(),v(C,null,{default:o(()=>[Ye,a(r,{data:e.joinRequestInfoList,stripe:""},{default:o(()=>[a(t,{label:"用户","show-overflow-tooltip":""},{default:o(c=>[a(p,{href:"/user/"+c.row.user.id,type:"primary"},{default:o(()=>[d(b(c.row.user.username),1)]),_:2},1032,["href"])]),_:1}),a(t,{prop:"time",label:"申请时间",width:"300"},{default:o(c=>[d(b(e.formatTime(c.row.time)),1)]),_:1}),a(t,{label:"分数"},{default:o(c=>[d(b(c.row.user.total_score),1)]),_:1}),a(t,{label:"解题数"},{default:o(c=>[d(b(c.row.user.solve_record.length),1)]),_:1}),a(t,{label:"操作"},{default:o(c=>[a(l,{size:"small",type:"success",onClick:n=>e.option(c.row,1)},{default:o(()=>[d("同意")]),_:2},1032,["onClick"]),a(l,{size:"small",type:"danger",onClick:n=>e.option(c.row,0)},{default:o(()=>[d("拒绝")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})}const te=U(ze,[["render",Je]]);const We=B({name:"TeamMember",components:{},props:{captain:{type:Object,default:()=>({})},memberList:{type:Object,default:()=>({})}},emits:["dismissalClick","transferClick"],setup(e,s){const i=M(),m=A({dismissal:u=>{s.emit("dismissalClick",u.id)},transfer:u=>{s.emit("transferClick",u.id)}});return{store:i,...E(m),...E(e)}}}),He=f("h3",null,"成员列表",-1);function Ge(e,s,i,m,u,h){const p=P,t=X,l=L,r=ee,C=Z,c=R;return e.memberList?(_(),v(c,{key:0},{default:o(()=>[He,a(C,{data:e.memberList.results,stripe:""},{default:o(()=>[a(t,{prop:"username",label:"用户","show-overflow-tooltip":""},{default:o(n=>[a(p,{href:"/user/"+n.row.id,type:"primary"},{default:o(()=>[d(b(n.row.username),1)]),_:2},1032,["href"])]),_:1}),a(t,{prop:"describe",label:"个性签名",width:"500","show-overflow-tooltip":""}),a(t,{prop:"total_score",label:"分数"}),a(t,{prop:"solve_record.length",label:"解题数"}),e.store.getters["UserInfo/isCaptain"](e.captain.id)?(_(),v(t,{key:0,label:"操作"},{default:o(n=>[e.store.getters["UserInfo/isCaptain"](n.row.id)?k("",!0):(_(),v(r,{key:0,width:"200","confirm-button-text":"确定","cancel-button-text":"取消",title:"请确定是否踢出该成员",onConfirm:g=>e.dismissal(n.row)},{reference:o(()=>[a(l,{size:"small",type:"danger"},{default:o(()=>[d("踢出")]),_:1})]),_:2},1032,["onConfirm"])),e.store.getters["UserInfo/isCaptain"](n.row.id)?k("",!0):(_(),v(r,{key:1,width:"250","confirm-button-text":"确认","cancel-button-text":"取消",title:"请确认是否转让队长给该成员",onConfirm:g=>e.transfer(n.row)},{reference:o(()=>[a(l,{size:"small",type:"warning"},{default:o(()=>[d("转让")]),_:1})]),_:2},1032,["onConfirm"]))]),_:1})):k("",!0)]),_:1},8,["data"])]),_:1})):k("",!0)}const oe=U(We,[["render",Ge]]),Ke=B({name:"TeamIntroduction",props:{teamInfo:{type:Object,default:()=>({})}},components:{},setup(e){return{...E(e)}}}),Qe=f("h3",null,"团队简介",-1);function Xe(e,s,i,m,u,h){const p=R;return e.teamInfo?(_(),v(p,{key:0},{default:o(()=>{var t;return[Qe,f("span",null,b((t=e.teamInfo)==null?void 0:t.describe),1)]}),_:1})):k("",!0)}const ne=U(Ke,[["render",Xe]]),Ze=B({name:"TeamProfile",props:{teamInfo:{type:Object,default:()=>({})}},components:{},emits:["joinTeamClick","changeTeamInfoClick","leaveTeamClick"],setup(e,s){const i=M(),m=D(!1),u=A({declare:"",describe:""}),h=V(()=>i.getters["UserInfo/haveTeam"]&&!i.getters["UserInfo/isCaptain"](i.state.UserInfo.team.captain)),p=A({formatTime:t=>x(t).format("YYYY-MM-DD"),joinTeamClick:()=>{s.emit("joinTeamClick")},changeTeamInfoClick:()=>{m.value=!1,s.emit("changeTeamInfoClick",u)},leaveTeamClick:()=>{s.emit("leaveTeamClick")}});return{store:i,visible:m,visibleLeave:h,teamChangeInfo:u,...E(p),...E(e)}}});const q=e=>(Te("data-v-7f1b7a2d"),e=e(),ye(),e),xe={key:0,class:"main"},et={class:"name"},tt={class:"button-box"},ot={class:"value"},nt=q(()=>f("div",null,"成员数",-1)),at=q(()=>f("div",null,"队长",-1)),st={class:"value"},lt=q(()=>f("div",null,"创建时间",-1)),it=["id"],rt={class:"dialog-footer"};function ut(e,s,i,m,u,h){const p=L,t=ee,l=Re,r=Ae,C=P,c=Le,n=R,g=Ve,O=Ne,se=je,le=Ue;return _(),S(Ie,null,[e.teamInfo?(_(),S("div",xe,[e.teamInfo?(_(),v(n,{key:0,class:"team-card"},{default:o(()=>{var T,z,Y,J;return[f("div",et,b((T=e.teamInfo)==null?void 0:T.name),1),f("span",null,b((z=e.teamInfo)==null?void 0:z.declare),1),f("div",tt,[e.store.getters["UserInfo/haveTeam"]?k("",!0):(_(),v(p,{key:0,type:"primary",onClick:e.joinTeamClick},{default:o(()=>[d("申请加入")]),_:1},8,["onClick"])),e.store.getters["UserInfo/isCaptain"]((J=(Y=e.teamInfo)==null?void 0:Y.captain)==null?void 0:J.id)?(_(),v(p,{key:1,type:"primary",onClick:s[0]||(s[0]=y=>e.visible=!0)},{default:o(()=>[d("修改信息")]),_:1})):k("",!0),e.visibleLeave?(_(),v(t,{key:2,width:"250","confirm-button-text":"确认","cancel-button-text":"取消",title:"请确认是否退出团队",onConfirm:e.leaveTeamClick},{reference:o(()=>[a(p,{type:"danger"},{default:o(()=>[d("退出团队")]),_:1})]),_:1},8,["onConfirm"])):k("",!0)]),a(l),a(c,{justify:"space-between",class:"info"},{default:o(()=>[a(r,{span:6,class:"member"},{default:o(()=>{var y,w;return[f("div",ot,b((w=(y=e.teamInfo)==null?void 0:y.member)==null?void 0:w.length),1),nt]}),_:1}),a(r,{span:6,class:"captain"},{default:o(()=>{var y,w;return[a(C,{href:"/user/"+((w=(y=e.teamInfo)==null?void 0:y.captain)==null?void 0:w.id),type:"success",class:"value"},{default:o(()=>{var W,H;return[d(b((H=(W=e.teamInfo)==null?void 0:W.captain)==null?void 0:H.username),1)]}),_:1},8,["href"]),at]}),_:1}),a(r,{span:6,class:"creation-time"},{default:o(()=>{var y;return[f("div",st,b(e.formatTime((y=e.teamInfo)==null?void 0:y.created_time)),1),lt]}),_:1})]),_:1})]}),_:1})):k("",!0)])):k("",!0),a(le,{modelValue:e.visible,"onUpdate:modelValue":s[4]||(s[4]=T=>e.visible=T),title:"Warning",width:"30%","align-center":""},{header:o(({titleId:T})=>[f("h3",{id:T},"修改团队信息",8,it)]),footer:o(()=>[f("span",rt,[a(p,{onClick:s[3]||(s[3]=T=>e.visible=!1)},{default:o(()=>[d("取消")]),_:1}),a(p,{type:"primary",onClick:e.changeTeamInfoClick},{default:o(()=>[d("确认")]),_:1},8,["onClick"])])]),default:o(()=>[a(se,{"label-width":"100px"},{default:o(()=>[a(O,{label:"宣言"},{default:o(()=>[a(g,{modelValue:e.teamChangeInfo.declare,"onUpdate:modelValue":s[1]||(s[1]=T=>e.teamChangeInfo.declare=T)},null,8,["modelValue"])]),_:1}),a(O,{label:"简介"},{default:o(()=>[a(g,{modelValue:e.teamChangeInfo.describe,"onUpdate:modelValue":s[2]||(s[2]=T=>e.teamChangeInfo.describe=T)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}const ae=U(Ze,[["render",ut],["__scopeId","data-v-7f1b7a2d"]]),ct=B({name:"TeamView",props:{},components:{TeamProfile:ae,TeamIntroduction:ne,TeamMember:oe,JoinRequest:te},setup(){const e=ge(),s=M(),i=D(),m=D(),u=D([]),h={team:Number(e.params.id)},p=A({loadAll:()=>{$(Number(e.params.id)).then(t=>{i.value=t.data}),j(h).then(t=>{m.value=t.data}),Be().then(t=>{u.value=t.data})},handleJoinTeamClick:()=>{var t,l;$e((t=s.state.UserInfo)==null?void 0:t.id,Number((l=i.value)==null?void 0:l.id)).then(r=>{F.success({title:"申请成功"})},r=>{console.log("失败")})},handleLeaveTeamClick:()=>{K(s.state.UserInfo.id).then(t=>{F.success({title:"退出团队成功"}),s.dispatch("UserInfo/updateUserInfo",s.state.UserInfo.id),$(Number(e.params.id)).then(l=>{i.value=l.data}),j(h).then(l=>{m.value=l.data})},t=>{console.log("失败")})},handleDismissalClick:t=>{K(t).then(l=>{$(Number(e.params.id)).then(r=>{i.value=r.data}),j(h).then(r=>{m.value=r.data}),F.success({title:"操作成功"})},l=>{console.log("失败")})},handleTransferClick:t=>{Fe(t).then(l=>{s.dispatch("UserInfo/updateUserInfo",s.state.UserInfo.id),$(Number(e.params.id)).then(r=>{i.value=r.data}),F.success({title:"操作成功"})},l=>{console.log("失败")})},handleChangeTeamInfoClick:t=>{we(Number(e.params.id),t.declare,t.describe).then(l=>{$(Number(e.params.id)).then(r=>{i.value=r.data}),F.success({title:"更新成功"})},l=>{console.log("失败")})},handleOptionClick:(t,l)=>{const r=u.value.findIndex(C=>C.id===t);r!==-1&&u.value.splice(r,1),De(t,l).then(C=>{l&&($(Number(e.params.id)).then(c=>{i.value=c.data}),j(h).then(c=>{m.value=c.data})),F.success({title:"操作成功"})},C=>{console.log("失败")})}});return Ee(()=>{p.loadAll()}),{store:s,teamInfo:i,memberList:m,joinRequestInfoList:u,...E(p)}}});const mt={class:"team"};function pt(e,s,i,m,u,h){var C,c,n;const p=ae,t=ne,l=oe,r=te;return _(),S("div",mt,[a(p,{teamInfo:e.teamInfo,onJoinTeamClick:e.handleJoinTeamClick,onChangeTeamInfoClick:e.handleChangeTeamInfoClick,onLeaveTeamClick:e.handleLeaveTeamClick},null,8,["teamInfo","onJoinTeamClick","onChangeTeamInfoClick","onLeaveTeamClick"]),a(t,{teamInfo:e.teamInfo,class:"introduction"},null,8,["teamInfo"]),a(l,{class:"member-list",captain:(C=e.teamInfo)==null?void 0:C.captain,memberList:e.memberList,onDismissalClick:e.handleDismissalClick,onTransferClick:e.handleTransferClick},null,8,["captain","memberList","onDismissalClick","onTransferClick"]),e.store.getters["UserInfo/isCaptain"]((n=(c=e.teamInfo)==null?void 0:c.captain)==null?void 0:n.id)?(_(),v(r,{key:0,class:"join-list",joinRequestInfoList:e.joinRequestInfoList,onOptionClick:e.handleOptionClick},null,8,["joinRequestInfoList","onOptionClick"])):k("",!0)])}const gt=U(ct,[["render",pt],["__scopeId","data-v-95030693"]]);export{gt as default};
